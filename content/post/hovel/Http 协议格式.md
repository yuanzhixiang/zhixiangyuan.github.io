---
title: "Http 协议格式"
date: 2019-10-27T10:01:55+08:00
keywords: []
description: ""
tags: [
    "网络协议"
]
categories: [
    "杂货铺"
]
autoCollapseToc: false
author: "yuanzx"
---

# 1 HTTP 请求报文

HTTP 请求报文由请求行、请求头部、空行和请求包体 4 个部分组成，如下图所示：

![HTTP 协议格式](/hub/2019/october/10.jpg)

## 1.1 请求行

请求行由方法字段、URL 字段和 HTTP 协议版本字段 3 个部分组成，它们之间使用空格隔开。

常用的 HTTP 请求方法有 GET、POST、HEAD、PUT、DELETE、OPTIONS、TRACE、CONNECT

- GET：当客户端要从服务器读取某个资源的时候，使用 GET 请求。请求参数需要放在 URL 后面，并且传递的参数长度有限制。
- POST：一般用于表单提交，将需要传递的参数封装在包体里面

## 1.2 请求头部

请求头部存放的都是键值对，以 ':' 分割，以下是一些常见的请求头

- User-Agent: 产生请求的浏览器类型
- Accept：客户端可识别的响应类型
- Accept-Language：客户端可接受的自然语言
- Accept-Encoding：客户端可接受的编码压缩格式
- Accept-Charset：可接受的应答的字符集
- Host：请求的主机名
- connection：连接方式，一般为 `<close|keepalive>`
- Cookie：存储与客户端扩展字段，向同一域名发送请求时会带上所存储的 Cookie

## 1.3 空行

最后一个请求头之后是一个空行，表示以下不再有请求头

## 1.4 请求包体

请求包体不在 GET 方法中使用，而是在 POST 方法中使用。与请求包体相关的最常用的请求头是包体类型（Content-Type）和包体长度（Content-Length）。

# 2 HTTP 响应报文

HTTP 响应报文由状态行、响应头部、空行和响应包体 4 个部分组成，如下图所示：

![HTTP 响应报文](/hub/2019/october/11.png)

## 2.1 状态行

状态行由协议版本、状态码和状态码的描述文本 3 个部分组成，它们之间使用空格隔开。

## 2.1.1 协议版本

目前 HTTP 的协议版本有 1.0、1.1、2.0

## 2.1.2 状态码

状态码由三位数字组成，第一位表示响应的类型，常用的状态码有五大类，如下所示：

1. 1xx：表示服务器已经接收了客户端的请求，客户端可继续发送请求
2. 2xx：表示服务器已成功接收到请求并进行处理
3. 3xx：表示服务器要求客户端重定向
4. 4xx：表示客户端的请求有非法内容
5. 5xx：表示服务器未能正常处理客户端的请求而出现意外错误

## 2.1.3 状态码描述文本

常见的一些状态码以及其描述文本

- `200 OK`: 表示客户端请求成功
- `401 Bad Request`: 表示请求未经授权，该状态代码必须与 WWW-Authenticate 响应头一起使用
- `403 Forbidden`: 表示服务器收到请求，但是拒绝提供服务，通常会在响应正文中给出不提供服务的原因
- `404 Not Found`: 请求的资源不存在，例如输入了错误的 URL
- `500 Internal Server Error`: 表示服务器发生不可预期的错误，导致无法完成客户端的请求
- `503 Service Unavailable`: 表示服务器当前不能够处理客户端的请求，在一段时间之后，服务器可能会恢复正常

## 2.2 响应头部

常见的响应头部：

- Location：Location 响应报头用于重定向接受者到一个新的位置
- Server：Server 响应报头包含了服务器用来处理请求的软件信息和版本。它和 User-Agent 请求报头是对应的，前者发送服务器端软件的信息，后者发送客户端软件（浏览器）和操作系统的信息。
- Vary：指示不可缓存的请求头列表
- Connection：连接方式
  - 对于请求来说
    - close 告诉 WEB 服务器或者代理服务器，在完成本次请求的响应后，断开连接，不等待本次连接的后续请求了
    - keepalive 告诉 WEB 服务器或者代理服务器，在完成本次请求的响应后，保持连接，等待本次连接的后续请求
  - 对于响应来说
    - close 连接已经关闭
    - keepalive 连接保持着，在等待本次连接的后续请求
- Keep-Alive：如果浏览器请求保持连接，则该头部表明希望 WEB 服务器保持连接多长时间（秒）。例如 Keep-Alive： 300
- WWW-Authenticate：WWW-Authenticate 响应报头域必须被包含在 401 (未授权的) 响应消息中，这个报头域和前面讲到的 Authorization 请求报头域是相关的，当客户端收到 401 响应消息，就要决定是否请求服务器对其进行验证。如果要求服务器对其进行验证，就可以发送一个包含了 Authorization 报头域的请求

## 2.3 空行

最后一个响应头部之后是一个空行，表示以下不再有响应头部

## 2.4 响应包体

服务器返回给客户端的文本信息

# 参考资料

1. [HTTP响应报文与工作原理详解](https://alleniverson.gitbooks.io/javaweb/content/%E7%AC%AC6%E7%AB%A0%20Http%E5%8D%8F%E8%AE%AE/HTTP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87%E4%B8%8E%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3.html)